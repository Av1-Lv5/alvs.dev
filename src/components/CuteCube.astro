<div class="cute-cube" id="cute-cube">
	<div class="face" id="cube-face">
		<div class="eye left"></div>
		<div class="eye right"></div>
		<div class="mouth"></div>
		<div class="cheeks left"></div>
		<div class="cheeks right"></div>
	</div>
</div>

<script>
	const cube = document.getElementById("cute-cube");
	const face = document.getElementById("cube-face");
	const eyes = document.querySelectorAll(".eye");

	let mouseX = 0;
	let mouseY = 0;
	let currentX = 0;
	let currentY = 0;
	let hasMoved = false;

	function animate() {
		if (!cube || !face) return;

		const rect = cube.getBoundingClientRect();
		const cubeCenterX = rect.left + rect.width / 2;
		const cubeCenterY = rect.top + rect.height / 2;

		// If mouse hasn't moved yet, look forward
		if (!hasMoved) {
			mouseX = cubeCenterX;
			mouseY = cubeCenterY;
		}

		// Calculate vectors from cube to mouse
		const dx = mouseX - cubeCenterX;
		const dy = mouseY - cubeCenterY;
		const dist = Math.sqrt(dx * dx + dy * dy);
		const angle = Math.atan2(dy, dx);

		// Max movement range in pixels
		const maxMove = 4;
		const intensity = Math.min(dist / 400, 1);

		const targetX = Math.cos(angle) * intensity * maxMove;
		const targetY = Math.sin(angle) * intensity * maxMove;

		// Smooth interpolation
		currentX += (targetX - currentX) * 0.15;
		currentY += (targetY - currentY) * 0.15;

		face.style.transform = `translate(${currentX}px, ${currentY}px)`;

		// Move eyes slightly more for a parallax effect
		eyes.forEach((eye) => {
			const eyeX = Math.cos(angle) * intensity * 2;
			const eyeY = Math.sin(angle) * intensity * 2;
			(eye as HTMLElement).style.transform =
				`translate(${eyeX}px, ${eyeY}px)`;
		});

		requestAnimationFrame(animate);
	}

	if (window.matchMedia("(hover: hover)").matches) {
		window.addEventListener("mousemove", (e) => {
			mouseX = e.clientX;
			mouseY = e.clientY;
			hasMoved = true;
		});

		// Initial start
		requestAnimationFrame(animate);
	}
</script>

<style>
	.cute-cube {
		height: 24px;
		width: 24px;
		background-color: var(--accent);
		border-radius: 6px;
		position: relative;
		display: flex;
		align-items: center;
		justify-content: center;
		overflow: hidden;
		transition: transform 0.2s ease;
	}

	.cute-cube:hover {
		transform: scale(1.1);
	}

	.face {
		position: relative;
		width: 100%;
		height: 100%;
		animation: look-around 8s infinite;
		will-change: transform;
	}

	/* Disable look-around animation on devices with hover (desktop) */
	@media (hover: hover) {
		.face {
			animation: none;
		}
	}

	.eye {
		position: absolute;
		top: 35%;
		width: 4px;
		height: 4px;
		background-color: #f0f0f0;
		border-radius: 50%;
		box-shadow: 0 0 1px rgba(0, 0, 0, 0.3);
		animation: blink 4s infinite;
	}

	.eye.left {
		left: 20%;
	}

	.eye.right {
		right: 20%;
	}

	.mouth {
		position: absolute;
		bottom: 25%;
		left: 50%;
		transform: translateX(-50%);
		width: 6px;
		height: 3px;
		border-bottom: 1.5px solid #f0f0f0;
		border-radius: 0 0 10px 10px;
		transition:
			height 0.2s,
			border-bottom 0.2s;
	}

	.cute-cube:hover .mouth {
		height: 5px;
		border-bottom-width: 2px;
	}

	.cheeks {
		position: absolute;
		top: 45%;
		width: 5px;
		height: 3px;
		background-color: rgba(255, 255, 255, 0.3);
		border-radius: 50%;
	}

	.cheeks.left {
		left: 10%;
	}

	.cheeks.right {
		right: 10%;
	}

	@keyframes blink {
		0%,
		48%,
		52%,
		100% {
			transform: scaleY(1);
		}
		50% {
			transform: scaleY(0.1);
		}
	}

	@keyframes look-around {
		0%,
		20% {
			transform: translate(0, 0);
		}
		25%,
		45% {
			transform: translate(-1px, 1px);
		}
		50%,
		70% {
			transform: translate(0, 0);
		}
		75%,
		95% {
			transform: translate(1px, -1px);
		}
		100% {
			transform: translate(0, 0);
		}
	}
</style>
